g2 = datatot%>%ggplot(aes(x=Index,y=beta_1,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(beta[1])) + xlab("Index")
ggsave("beta1chain.eps",plot = g2, width = 6, height = 6, dpi = 600)
###### chain beta2 #######
g3 = datatot%>%ggplot(aes(x=Index,y=beta_2,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(beta[2])) + xlab("Index")
ggsave("beta2chain.eps",plot = g3, width = 6, height = 6, dpi = 600)
###### chain beta3 #######
g4 = datatot%>%ggplot(aes(x=Index,y=beta_3,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(beta[3])) + xlab("Index")
ggsave("beta3chain.eps",plot = g4, width = 6, height = 6, dpi = 600)
##### chains betas #########
betaschains = ggarrange(g1,g2,g3,g4,common.legend = TRUE,legend = "bottom")
###### chain sigma2 #######
g5 = datatot%>%ggplot(aes(x=Index,y=sigma2,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(sigma^2)) + xlab("Index")
ggsave("sigma2chain.eps",plot = g5, width = 6, height = 6, dpi = 600)
###### chain rho #######
g6 = datatot%>%ggplot(aes(x=Index,y=rho,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(rho)) + xlab("Index")
ggsave("rhochain.eps",plot = g6, width = 6, height = 6, dpi = 600)
###### chain gamma #######
g7 = datatot%>%ggplot(aes(x=Index,y=phi,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(gamma)) + xlab("Index")
ggsave("gammachain.eps",plot = g7, width = 6, height = 6, dpi = 600)
###### chain tau2 #######
g8 = datatot%>%ggplot(aes(x=Index,y=tau2,color=factor(chain)))+ geom_line() +
theme_bw() +
scale_colour_grey(name = "Chain",start = 0.3,end = 0.7, labels = labelsb) +
ylab(expression(tau^2)) + xlab("Index")
ggsave("tau2chain.eps",plot = g8, width = 6, height = 6, dpi = 600)
##### chains covariance parameters #######
covchains = ggarrange(g5,g6,g7,g8,common.legend = TRUE,legend = "bottom")
covchains
##### acf plots for all the parameters
library(ggfortify)
##### ACF beta0 #####
p1 <- autoplot(acf(cad1$betaF[,1], plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p1 = p1+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(beta[0]))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p1
ggsave("acfbeta0.eps",plot = p1, width = 6, height = 6, dpi = 600)
##### ACF beta1 ########
p2 <- autoplot(acf(cad1$betaF[,2], plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p2 = p2+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(beta[1]))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+ theme_bw() +
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p2
ggsave("acfbeta1.eps",plot = p2, width = 6, height = 6, dpi = 600)
##### ACF beta2 ########
p3 <- autoplot(acf(cad1$betaF[,3], plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p3 = p3+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(beta[2]))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p3
ggsave("acfbeta2.eps",plot = p3, width = 6, height = 6, dpi = 600)
##### ACF beta3 ########
p4 <- autoplot(acf(cad1$betaF[,4], plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p4 = p4+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(beta[3]))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p4
ggsave("acfbeta3.eps",plot = p4, width = 6, height = 6, dpi = 600)
betasacf = ggarrange(p1,p2,p3,p4, common.legend = TRUE, legend = "bottom")
##### ACF sigma2 ########
p5 <- autoplot(acf(cad1$sigma2F, plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p5 = p5+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(sigma^2))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p5
ggsave("acfsigma2.eps",plot = p5, width = 6, height = 6, dpi = 600)
##### ACF rho ########
p6 <- autoplot(acf(cad1$rhoF, plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p6 = p6+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(rho))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw() +
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p6
ggsave("acfrho.eps",plot = p6, width = 6, height = 6, dpi = 600)
##### ACF gamma ########
p7 <- autoplot(acf(cad1$phiF, plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p7 = p7+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(gamma))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p7
ggsave("acfgamma.eps",plot = p7, width = 6, height = 6, dpi = 600)
##### ACF tau2 ########
p8 <- autoplot(acf(cad1$tau2F, plot = FALSE,lag.min=0,lag.max=30), conf.int.value = 0.95
,conf.int.col=1)
p8 = p8+geom_hline(yintercept = 0)+ coord_cartesian(x=c(0,28.5))+
ggtitle(expression(tau^2))+
theme(plot.title = element_text(hjust = 0.5)) + theme_bw()+
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
p8
ggsave("acftau2.eps",plot = p8, width = 6, height = 6, dpi = 600)
covaacf = ggarrange(p5,p6,p7,p8, common.legend = TRUE, legend = "bottom")
###### posterior densities beta######
#### density beta0 ########
beta0post = ggplot(datatot, aes(x = beta_0)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(beta[0]),
y = "Frequency"
) +
theme_bw(base_size = 16) +
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
beta0post
ggsave("beta0pos.eps",plot = beta0post, width = 6, height = 6, dpi = 600)
#### density beta1 ########
beta1post = ggplot(datatot, aes(x = beta_1)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(beta[1]),
y = "Frequency"
) +
theme_bw(base_size = 16) +
theme(
plot.title = element_text(hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
beta1post
ggsave("beta1pos.eps",plot = beta1post, width = 6, height = 6, dpi = 600)
#### density beta2 ########
beta2post = ggplot(datatot, aes(x = beta_2)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(beta[2]),
y = "Frequency"
) +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text( size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
beta2post
ggsave("beta2pos.eps",plot = beta2post, width = 6, height = 6, dpi = 600)
#### density beta3 ########
beta3post = ggplot(datatot, aes(x = beta_3)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(beta[3]),
y = "Frequency"
) +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
ggsave("beta3pos.eps",plot = beta3post, width = 6, height = 6, dpi = 600)
##### density beta
betaposterior = ggarrange(beta0post,beta1post,beta2post,beta3post)
#### density sigma2 ########
sigma2post = ggplot(datatot, aes(x = sigma2)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(sigma^2),
y = "Frequency"
)  +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
sigma2post
ggsave("sigma2pos.eps",plot = sigma2post, width = 6, height = 6, dpi = 600)
#### density rho ########
rhopost = ggplot(datatot, aes(x = rho)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(rho),
y = "Frequency"
)  +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
rhopost
ggsave("rhopos.eps",plot = rhopost, width = 6, height = 6, dpi = 600)
#### density gamma ########
phipost = ggplot(datatot, aes(x = phi)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(gamma),
y = "Frequency"
)  +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
phipost
ggsave("gammapos.eps",plot = phipost, width = 6, height = 6, dpi = 600)
#### density tau2 ########
tau2post = ggplot(datatot, aes(x = tau2)) +
# Smooth density curve (darker gray, thinner line)
geom_histogram(aes(y = after_stat(count / sum(count))),
fill = "gray50",     # darker gray fill
color = "black",     # black border
alpha = 0.8,         # more transparent shading
linewidth = 0.3
) +
labs(
x = expression(tau^2),
y = "Frequency"
)  +
theme_bw(base_size = 16) +
theme(
plot.title = element_text( hjust = 0.5, size = 23),
axis.title = element_text(size = 22),
axis.text = element_text(size = 20),
panel.grid.minor = element_blank()
)
tau2post
ggsave("tau2pos.eps",plot = tau2post, width = 6, height = 6, dpi = 600)
covaposteriori = ggarrange(sigma2post,rhopost,phipost,tau2post)
ggsave("covaposteriori.eps",plot = covaposteriori, width = 10, height = 10, dpi = 600)
######################################################
########## Lines to install the auxiliarcpp package##
####################################################
#setwd("C:/Users/ALEJANDRO/OneDrive/Documentos/Alejo/postdoc20242/censored_network_dagar/datasets/Beijing/codes sumarized")
#install.packages("auxiliarcpp_0.0.0.9000.tar.gz", type="source")
library(tmvtnorm)
library(doParallel)
library(doSNOW)
library(data.table)
library(dplyr)
library(ggplot2)
library(auxiliarcpp)
##### fixing the work directory #######################
setwd("C:/Users/ALEJANDRO/OneDrive/Documentos/Alejo/postdoc20242/censored_network_dagar/datasets/Beijing/codes sumarized/")
######################################################
###############################################
########## preparing the dataset #############
#############################################
data = fread(paste0("Estaciones_unidas_rushhour.csv"))
adj_matrix = readRDS("adj_matrix.rds")
adj_matcom = adj_matrix + t(adj_matrix)
datapre = data#%>%select("data", "station", "aggpm25","aggpm10" ,
#         "aggtemp","aggrain", "aggsumrain", "aggpres", "aggwsmp")
regions = c("Aotizhongxin", "Changping", "Dingling", "Dongsi",
"Guanyuan", "Gucheng", "Huairou", "Nongzhanguan",
"Shunyi", "Tiantan","Wanliu", "Wanshouxigong")
print(apply(datapre,2,function(x) sum(is.na(x))))
datapre2 = datapre%>%group_by("station")%>%
mutate (aggtemp = if_else(is.na(TEMP),mean(TEMP,na.rm = TRUE),TEMP),
aggrain = if_else(is.na(aggrain),mean(aggrain,na.rm = TRUE),aggrain),
aggsumrain = if_else(is.na(aggsumrain),mean(aggsumrain,na.rm = TRUE),aggsumrain),
aggpres = if_else(is.na(PRES),mean(PRES,na.rm = TRUE),PRES),
aggwsmp = if_else(is.na(WSPM),mean(aggwsmp,na.rm = TRUE),WSPM))%>%ungroup()
#### prediction time without missing data "data>= "2017-01-24" & data<="2017-01-31"
datapre2 = datapre2%>%filter(data>= "2016-11-25" & data<="2017-02-25")
print(apply(datapre2,2,function(x) sum(is.na(x))))
ytotobs = datapre2$CO
indicens3 = as.numeric(is.na(ytotobs))
lower = rep(-Inf,sum(indicens3 ==1))
upper = rep(Inf,sum(indicens3 ==1))
ytotobs[indicens3 == 1] = mean(ytotobs,na.rm = TRUE)
xtotobs = cbind (1,datapre2$aggtemp - mean(datapre2$aggtemp),datapre2$aggwsmp - mean(datapre2$aggwsmp), (datapre2$aggpres - mean(datapre2$aggpres))/100)
y = log(ytotobs)
N_time_obs = length(ytotobs[datapre2$station == "Shunyi"])
lags = N_time_obs
###################################################################
##### obtained chains: DAGAR AR 1, DAGAR AR 2, CAR ###############
#################################################################
resar1dagar = readRDS("cad1ar1dagar_Beijing.rds")
resultsar2dagar = readRDS("ar2dagar_beijing_21_40000.rds")
resar2dagar = resultsar2dagar[[1]]
rescar =  readRDS("car_beijing_2_40000.rds")
thetatotar1dagar = cbind(resar1dagar$betaF,resar1dagar$sigma2F,resar1dagar$rhoF, resar1dagar$psiF, resar1dagar$phiF)
thetatotar2dagar = cbind(resar2dagar$betaF,resar2dagar$sigma2F,resar2dagar$rhoF, resar2dagar$psiF, resar2dagar$phi1F,resar2dagar$phi2F)
thetatotcar = cbind(rescar$betaF,rescar$sigma2F,rescar$rho_sF, rescar$rho_tF, rescar$rho_stF)
#######################################
######## summarized models ###########
#####################################
names1 = c(paste0("beta_",0:3), "sigma2", "rho", "phi", "rho*phi","tau2")
names2 = c(paste0("beta_",0:3), "sigma2", "rho", "phi_1", "phi_2", "rho*phi", "rho*phi2", "tau2")
#### DAGAR AR 1 ############
rhophi = resar1dagar$rhoF*resar1dagar$phiF
rhophiest = quantile(rhophi,c(0.025,0.5,0.975))
thetaestar1dagar = rbind(t(resar1dagar$betaest),resar1dagar$sigmaest,resar1dagar$rhoest,resar1dagar$phiest,rhophiest,resar1dagar$tau2est)
rownames(thetaestar1dagar) = names1
thetaestar1dagar[, c(1,2)] <- thetaestar1dagar[, c(2,1)]
colnames(thetaestar1dagar) = c( "50%","2.5%", "97.5%")
thetaestar1dagar
##### estimated values ###
round(thetaestar1dagar,3)
#### DAGAR AR 2 ############
rhophi1 = resar2dagar$rhoF*resar2dagar$phi1F
rhophi1est = quantile(rhophi1,c(0.025,0.5,0.975))
rhophi2 = resar2dagar$rhoF*resar2dagar$phi2F
rhophi2est = quantile(rhophi2,c(0.025,0.5,0.975))
thetaestar2dagar = rbind(t(resar2dagar$betaest),resar2dagar$sigmaest,resar2dagar$rhoest,resar2dagar$phi1est,resar2dagar$phi2est,
rhophi1est, rhophi2est, resar2dagar$tau2est)
rownames(thetaestar2dagar) = names2
thetaestar2dagar[, c(1,2)] <- thetaestar2dagar[, c(2,1)]
colnames(thetaestar2dagar) = c( "50%","2.5%", "97.5%")
##### estimated values ###
round(thetaestar2dagar,3)
#### CAR ###########
thetaestcar = rbind(t(rescar$betaest),rescar$sigmaest,rescar$rho_s_est,rescar$rho_t_est,rescar$rho_st_est)
names3 = c(paste0("beta_",0:3), "sigma2", "rho_s", "rho_t", "rho_st")
rownames(thetaestcar) = names3
thetaestcar[, c(1,2)] <- thetaestcar[, c(2,1)]
colnames(thetaestcar) = c( "50%","2.5%", "97.5%")
##### estimated values ###
round(thetaestcar,3)
##############################################
##### MODEL SELECTION CRITERIA (LOG-LIKELIHOODS)##############
#############################################
##### log_likelihoods from the chains #########
log_lik_ar1dagar = readRDS("log_lik_ar1dagar.rds")
log_lik_ar2dagar = readRDS("log_lik_ar2dagar.rds")
log_lik_car = readRDS("log_lik_car.rds")
###### expected AIC and expected BIC #######
dbarraar1dagar = -2*mean(log_lik_ar1dagar)
dbarraar2dagar = -2*mean(log_lik_ar2dagar)
dbarracar = -2*mean(log_lik_car)
meanthetaar1dagar = apply(thetatotar1dagar,2,mean)
meanbetaar1dagar = meanthetaar1dagar[1:ncol(xtotobs)]
meansigmaar1dagar = meanthetaar1dagar[ncol(xtotobs)+1]
meanrhoar1dagar =  meanthetaar1dagar[ncol(xtotobs)+2]
meanpsiar1dagar =  meanthetaar1dagar[ncol(xtotobs)+3]
meanphiar1dagar =  meanthetaar1dagar[ncol(xtotobs)+4]
meanthetaar2dagar = apply(thetatotar2dagar,2,mean)
meanbetaar2dagar = meanthetaar2dagar[1:ncol(xtotobs)]
meansigmaar2dagar = meanthetaar2dagar[ncol(xtotobs)+1]
meanrhoar2dagar =  meanthetaar2dagar[ncol(xtotobs)+2]
meanpsiar2dagar =  meanthetaar2dagar[ncol(xtotobs)+3]
meanphi1ar2dagar =  meanthetaar2dagar[ncol(xtotobs)+4]
meanphi2ar2dagar =  meanthetaar2dagar[ncol(xtotobs)+5]
meanthetacar = apply(thetatotcar,2,mean)
meanbetacar = meanthetacar[1:ncol(xtotobs)]
meansigmacar = meanthetacar[ncol(xtotobs)+1]
meanrhocar =  meanthetacar[ncol(xtotobs)+2]
meanpsicar =  meanthetacar[ncol(xtotobs)+3]
meanphicar =  meanthetacar[ncol(xtotobs)+4]
destar1dagar = -2*log_likelihood_ar1_fast_pkg_cpp(x = xtotobs,y = y ,cc = indicens3,lag = lags, adjmatinf = adj_matrix,
theta =  c(meanbetaar1dagar,meansigmaar1dagar,meanrhoar1dagar,meanpsiar1dagar,
meanphiar1dagar), lower = as.vector(lower), upper = as.vector(upper),
pkg = "auxiliarcpp")
destar2dagar = -2*log_likelihood_ar2_fast_pkg_cpp(x = xtotobs,y = y ,cc = indicens3,lag = lags, adjmatinf = adj_matrix,
theta =  c(meanbetaar2dagar,meansigmaar2dagar,meanrhoar2dagar,meanpsiar2dagar,
meanphi1ar2dagar,meanphi2ar2dagar), lower = as.vector(lower), upper = as.vector(upper),
pkg = "auxiliarcpp",fun_name = "spatimecovar_ar2_cpp")
destcar= -2*log_likelihood_car_fast_cpp(x = xtotobs,y = y ,cc = indicens3,lag = lags, adj_matcom = adj_matcom,
theta =  meanthetacar, lower = as.matrix(lower), upper = as.matrix(upper))
##############################################
##### MODEL SELECTION CRITERIA ##############
#############################################
#### DAGAR AR1 ###########
DICar1dagar = 2*dbarraar1dagar - destar1dagar
EAICar1dagar = dbarraar1dagar + 2*ncol(thetatotar1dagar)
EBICar1dagar = dbarraar1dagar + 2*ncol(thetatotar1dagar)*log(nrow(thetatotar1dagar))
#### DAGAR AR2 ###########
DICar2dagar = 2*dbarraar2dagar - destar2dagar
EAICar2dagar = dbarraar2dagar + 2*ncol(thetatotar2dagar)
EBICar2dagar = dbarraar2dagar + 2*ncol(thetatotar2dagar)*log(nrow(thetatotar2dagar))
#### CAR ###########
DICcar = 2*dbarracar - destcar
EAICcar = dbarracar + 2*ncol(thetatotcar)
EBICcar = dbarracar + 2*ncol(thetatotcar)*log(nrow(thetatotcar))
pred_res_ar1_dagar = readRDS("results_pred_dens_2_ar1dagar.rds")
pred_res_ar2_dagar = readRDS("results_pred_dens_2_ar2dagar.rds")
pred_res_car = readRDS("results_pred_dens_car.rds")
pred1 = t(pred_res_ar1_dagar)
pred2 =t(pred_res_ar2_dagar)
pred3 = t(pred_res_car)
library(loo)
elpddagar = elpd(pred1)
elpddagar2 = elpd(pred2)
elpdcar = elpd(pred3)
ELPD = c(elpddagar$estimates[1,1], elpddagar2$estimates[1,1], elpdcar$estimates[1,1])
##### ALL models criteria #####
DIC = c(DICar1dagar,DICar2dagar,DICcar)
EAIC  = c(EAICar1dagar,EAICar2dagar,EAICcar)
EBIC  = c(EBICar1dagar,EBICar2dagar,EBICcar)
#################################
###### SUMMARIZED CRITERIA #####
################################
criteria = rbind(DIC,EAIC,EBIC,ELPD)
colnames(criteria) = c("DAGAR - AR(1)", "DAGAR - AR(2)", "CAR")
round(criteria,3)
View(pred1)
